# グリッドトグルボタン押下不可問題

## 発生日時
2025-01-10

## 症状
- グリッドモードをONにすると、グリッドトグルボタンが押せなくなる
- グリッドモードからOFFに戻せない状態になる
- コンソールログでは「グリッド表示モード: ON」と表示されるが、その後ボタンが反応しない

## 原因
**z-indexの階層問題**
- グリッドオーバーレイのz-index: 999999
- グリッドトグルボタンのz-index: 9999
- オーバーレイがボタンより上層に配置されていた
- `pointer-events: none`が設定されていたが、何らかの理由で一部の要素で効いていなかった可能性

## 解決方法（v0.34で実装済み）
1. **グリッドトグルボタンのz-indexを10000001に設定**
   - オーバーレイより確実に上層に配置
   
2. **すべてのグリッド要素にpointer-events: noneを明示的に設定**
   - オーバーレイ本体
   - グリッド線（垂直・水平）
   - ラベル要素

## 修正コード
```javascript
// ボタンのz-index
.grid-toggle {
    z-index: 10000001;  // 最上位に設定
}

// オーバーレイ
overlay.style.cssText = `
    pointer-events: none !important;
    z-index: 10000000;
`;

// グリッド線とラベル
pointer-events: none;
```

## 教訓
- z-indexの階層管理は慎重に行う必要がある
- 特に動的に生成される要素は、すべてにpointer-eventsを明示的に設定する
- ボタンなどのインタラクティブ要素は、オーバーレイより高いz-indexを持つべき

## 関連バージョン
- 問題発生: v0.33以前
- 修正完了: v0.34